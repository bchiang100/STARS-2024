typedef enum logic {
    OFF = 1'b0,
    ON = 1'b1
} MODE_TYPES;

module sound_generator(
    input logic clk, nRst, goodColl, badColl, buttonPressed,
    input logic [3:0] direction,
    output logic playSound
);
logic newGoodColl, newBadColl;
logic [3:0] newDirection;
logic [8:0] freq;

MODE_TYPES next_state;
MODE_TYPES mode_o; // current state
always_ff @(posedge clk) begin
    newGoodColl <= goodColl;
    newBadColl <= badColl;
    newDirection <= direction;
end
always_ff @(posedge clk, negedge nRst) begin
    if (~nRst) begin
        mode_o <= ON;
    end else begin
        mode_o <= next_state;
    end
end

always_comb begin
    playSound = 1'b0;
    next_state = mode_o;
    case (mode_o)
        ON:
            if (buttonPressed) begin
                next_state = OFF;
            end
            else if (newGoodColl || newBadColl || |newDirection) begin
                playSound = 1'b1;
            end
        OFF:
            if (buttonPressed) begin
                next_state = ON;
            end
    endcase
end

always_comb begin
    freq = 0;
    if (goodColl)
        freq = 440; // A
    if (badColl)
        freq = 311; // D Sharp
    if (|direction)
        freq = 262; // C
end
endmodule
